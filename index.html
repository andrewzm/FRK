<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="A tool for spatial/spatio-temporal modelling and prediction with large datasets. The approach models the field, and hence the covariance function, using a set of basis functions. This fixed-rank basis-function representation facilitates the modelling of big data, and the method naturally allows for non-stationary, anisotropic covariance functions. Discretisation of the spatial domain into so-called basic areal units (BAUs) facilitates the use of observations with varying support (i.e., both point-referenced and areal supports, potentially simultaneously), and prediction over arbitrary user-specified regions. `FRK` also supports inference over various manifolds, including the 2D plane and 3D sphere, and it provides helper functions to model, fit, predict, and plot with relative ease. Version 2.0.0 and above also supports the modelling of non-Gaussian data (e.g., Poisson, binomial, negative-binomial, gamma, and inverse-Gaussian) by employing a generalised linear mixed model (GLMM) framework. Zammit-Mangion and Cressie &lt;doi:10.18637/jss.v098.i04&gt; describe `FRK` in a Gaussian setting, and detail its use of basis functions and BAUs, while Sainsbury-Dale, Zammit-Mangion, and Cressie &lt;doi:10.18637/jss.v108.i10&gt; describe `FRK` in a non-Gaussian setting; two vignettes are available that summarise these papers and provide additional examples.">
<title>Fixed Rank Kriging • FRK</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Fixed Rank Kriging">
<meta property="og:description" content="A tool for spatial/spatio-temporal modelling and prediction with large datasets. The approach models the field, and hence the covariance function, using a set of basis functions. This fixed-rank basis-function representation facilitates the modelling of big data, and the method naturally allows for non-stationary, anisotropic covariance functions. Discretisation of the spatial domain into so-called basic areal units (BAUs) facilitates the use of observations with varying support (i.e., both point-referenced and areal supports, potentially simultaneously), and prediction over arbitrary user-specified regions. `FRK` also supports inference over various manifolds, including the 2D plane and 3D sphere, and it provides helper functions to model, fit, predict, and plot with relative ease. Version 2.0.0 and above also supports the modelling of non-Gaussian data (e.g., Poisson, binomial, negative-binomial, gamma, and inverse-Gaussian) by employing a generalised linear mixed model (GLMM) framework. Zammit-Mangion and Cressie &lt;doi:10.18637/jss.v098.i04&gt; describe `FRK` in a Gaussian setting, and detail its use of basis functions and BAUs, while Sainsbury-Dale, Zammit-Mangion, and Cressie &lt;doi:10.18637/jss.v108.i10&gt; describe `FRK` in a non-Gaussian setting; two vignettes are available that summarise these papers and provide additional examples.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">FRK</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/andrewzm/FRK/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<!-- badges: end -->
<div class="section level1">
<div class="page-header"><h1 id="fixed-rank-kriging-">Fixed Rank Kriging <img align="right" width="100" src="https://github.com/andrewzm/FRK/blob/master/man/figures/FRK_logo2.png?raw=true"><a class="anchor" aria-label="anchor" href="#fixed-rank-kriging-"></a>
</h1></div>
<p>The package <code>FRK</code> is available on CRAN! To install, please type</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"FRK"</span><span class="op">)</span></span></code></pre></div>
<p>To install the most recent development version, please load <code>devtools</code> and type</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install_github</span><span class="op">(</span><span class="st">"andrewzm/FRK"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>A paper introducing the package is available <a href="https://www.jstatsoft.org/article/view/v098i04" class="external-link">here</a>. A paper detailing the approach in a non-Gaussian setting is available <a href="https://arxiv.org/abs/2110.02507" class="external-link">here</a> (a six-page summary of this paper is available <a href="https://github.com/andrewzm/FRK/raw/master/FRKv2_6page.pdf" class="external-link">here</a>).</p>
<p>The vignette “FRK_intro” summarises the package, gives details on the EM algorithm that may be employed in a Gaussian setting, and provides several examples. Another vignette, “FRK_non-Gaussian”, summarises inference in a non-Gaussian setting (where a Laplace approximation is used), and contains examples using non-Gaussian data and the newly available plotting methods. To access the vignettes, please click on the following links:</p>
<p><a href="https://cran.r-project.org/web/packages/FRK/vignettes/FRK_intro.pdf" class="external-link">Introduction to FRK</a></p>
<p><a href="https://cran.r-project.org/web/packages/FRK/vignettes/FRK_non-Gaussian.pdf" class="external-link">Tutorial on modelling spatial and spatio-temporal non-Gaussian data with FRK</a></p>
<p>A <code>pkgdown</code> page is also available <a href="https://andrewzm.github.io/FRK/" class="external-link">here</a>.</p>
<div class="section level2">
<h2 id="supporting-and-citing">Supporting and citing<a class="anchor" aria-label="anchor" href="#supporting-and-citing"></a>
</h2>
<p>If you use <code>FRK</code> in your work, research, or other activities, please cite it using the information provided by <code>citation("FRK")</code>.</p>
</div>
<div class="section level2">
<h2 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h2>
<p>Package: FRK</p>
<p>Type: Package</p>
<p>Title: Fixed Rank Kriging</p>
<p>Version: 2.1.5</p>
<p>Date: 2023-01-30</p>
<p>Author: Andrew Zammit-Mangion, Matthew Sainsbury-Dale</p>
<p>Maintainer: Andrew Zammit-Mangion <a href="mailto:andrewzm@gmail.com" class="email">andrewzm@gmail.com</a></p>
<p>Description: A tool for spatial/spatio-temporal modelling and prediction with large datasets. The approach models the field, and hence the covariance function, using a set of basis functions. This fixed-rank basis-function representation facilitates the modelling of big data, and the method naturally allows for non-stationary, anisotropic covariance functions. Discretisation of the spatial domain into so-called basic areal units (BAUs) facilitates the use of observations with varying support (i.e., both point-referenced and areal supports, potentially simultaneously), and prediction over arbitrary user-specified regions. <code>FRK</code> also supports inference over various manifolds, including the 2D plane and 3D sphere, and it provides helper functions to model, fit, predict, and plot with relative ease. Version 2.0.0 and above also supports the modelling of non-Gaussian data (e.g., Poisson, binomial, negative-binomial, gamma, and inverse-Gaussian) by employing a generalised linear mixed model (GLMM) framework. Zammit-Mangion and Cressie <a href="doi:10.18637/jss.v098.i04" class="uri">doi:10.18637/jss.v098.i04</a> describe <code>FRK</code> in a Gaussian setting, and detail its use of basis functions and BAUs, while Sainsbury-Dale et al. &lt;arXiv:2110.02507&gt; describe <code>FRK</code> in a non-Gaussian setting; two vignettes are available that summarise these papers and provide additional examples.</p>
<ul>
<li>Zammit-Mangion, A. &amp; Cressie N. (2021). “FRK: an R package for spatial and spatio-temporal prediction with large datasets.” Journal of Statistical Software, 98, 1-48.</li>
<li>Sainsbury-Dale, M., Zammit-Mangion, A. &amp; Cressie, N. (2023). “Modelling Big, Heterogeneous, Non-Gaussian Spatial and Spatio-Temporal Data using FRK” Journal of Statistical Software, accepted for publication, <a href="https://arxiv.org/abs/2110.02507" class="external-link uri">https://arxiv.org/abs/2110.02507</a>.</li>
</ul>
<p>License: GPL (&gt;= 2)</p>
</div>
<div class="section level2">
<h2 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<div class="section level3">
<h3 id="gaussian-data">Gaussian data<a class="anchor" aria-label="anchor" href="#gaussian-data"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://andrewzm.github.io/FRK/" class="external-link">"FRK"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/edzer/sp/" class="external-link">"sp"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">"ggpubr"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Setup</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">1000</span>                                                  <span class="co"># Sample size</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">RNGversion</a></span><span class="op">(</span><span class="st">"3.6.0"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>                           <span class="co"># Fix seed</span></span>
<span><span class="va">zdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>, y<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span>               <span class="co"># Generate random locs</span></span>
<span><span class="va">zdf</span><span class="op">$</span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">8</span> <span class="op">*</span> <span class="va">zdf</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">8</span> <span class="op">*</span> <span class="va">zdf</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>  <span class="co"># Simulate data</span></span>
<span><span class="fu"><a href="https://edzer.github.io/sp/reference/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">zdf</span><span class="op">)</span> <span class="op">=</span> <span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span>                                    <span class="co"># Turn into sp object</span></span>
<span></span>
<span><span class="co">## Run FRK</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/SRE.html">FRK</a></span><span class="op">(</span>f <span class="op">=</span> <span class="va">z</span> <span class="op">~</span> <span class="fl">1</span>,                         <span class="co"># Formula to FRK</span></span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">zdf</span><span class="op">)</span>,                         <span class="co"># All datasets are supplied in list</span></span>
<span>         n_EM <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>                         <span class="co"># Max number of EM iterations</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span>                          <span class="co"># Prediction stage</span></span>
<span></span>
<span><span class="co">## Plotting</span></span>
<span><span class="va">plotlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">pred</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">plotlist</span>, nrow <span class="op">=</span> <span class="fl">1</span>, legend <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
<!---
ggsave(
  filename = "Gaussian_data.png", device = "png",
  width = 10, height = 4,
  path = "man/figures/"
)
--->
<div class="float">
<img src="https://github.com/andrewzm/FRK/blob/master/man/figures/Gaussian_data.png?raw=true" alt="(Left) Gaussian data. (Centre) Predictions. (Right) Standard errors."><div class="figcaption">(Left) Gaussian data. (Centre) Predictions. (Right) Standard errors.</div>
</div>
</div>
<div class="section level3">
<h3 id="non-gaussian-data">Non-Gaussian data<a class="anchor" aria-label="anchor" href="#non-gaussian-data"></a>
</h3>
<p>Here we analyse simulated Poisson data. We signify a Poisson data model with a mean response that is modelled using the square-root link function by setting <code>response = "poisson"</code> and <code>link = "sqrt"</code> in <code><a href="reference/SRE.html">FRK()</a></code>. Other non-Gaussian response distributions available in <code>FRK</code> are the binomial, negative-binomial, gamma, and inverse-Gaussian distributions.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Simulate Poisson data using the previous example's data to construct a mean</span></span>
<span><span class="va">zdf</span><span class="op">$</span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">m</span>, lambda <span class="op">=</span> <span class="va">zdf</span><span class="op">$</span><span class="va">z</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Run FRK</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/SRE.html">FRK</a></span><span class="op">(</span>f <span class="op">=</span> <span class="va">z</span> <span class="op">~</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">zdf</span><span class="op">)</span>,                          </span>
<span>         response <span class="op">=</span> <span class="st">"poisson"</span>,         <span class="co"># Poisson data model</span></span>
<span>         link <span class="op">=</span> <span class="st">"sqrt"</span><span class="op">)</span>                <span class="co"># square-root link function</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span>                            </span>
<span></span>
<span><span class="co">## Plotting</span></span>
<span><span class="va">plotlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">pred</span><span class="op">$</span><span class="va">newdata</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">plotlist</span><span class="op">$</span><span class="va">z</span>, <span class="va">plotlist</span><span class="op">$</span><span class="va">p_mu</span>, <span class="va">plotlist</span><span class="op">$</span><span class="va">interval90_mu</span>,</span>
<span>          nrow <span class="op">=</span> <span class="fl">1</span>, legend <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
<!---
ggsave(
  filename = "Poisson_data.png", device = "png",
  width = 10, height = 4,
  path = "man/figures/"
)
--->
<div class="float">
<img src="https://github.com/andrewzm/FRK/blob/master/man/figures/Poisson_data.png?raw=true" alt="(Left) Poisson data. (Centre) Prediction of the mean response. (Right) Prediction interval width of the mean response."><div class="figcaption">(Left) Poisson data. (Centre) Prediction of the mean response. (Right) Prediction interval width of the mean response.</div>
</div>
</div>
<div class="section level3">
<h3 id="spatio-temporal-data">Spatio-temporal data<a class="anchor" aria-label="anchor" href="#spatio-temporal-data"></a>
</h3>
<p>We now analyse spatio-temporal data, using the NOAA dataset.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Setup</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/edzer/spacetime" class="external-link">"spacetime"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"NOAA_df_1990"</span><span class="op">)</span></span>
<span><span class="va">Tmax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">NOAA_df_1990</span>, <span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">7</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op">==</span> <span class="fl">1993</span><span class="op">)</span></span>
<span><span class="va">Tmax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span><span class="va">Tmax</span>, <span class="op">{</span><span class="va">time</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">year</span>,<span class="va">month</span>,<span class="va">day</span>,sep<span class="op">=</span><span class="st">"-"</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">STObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spacetime/man/stconstruct.html" class="external-link">stConstruct</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Tmax</span>, space <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lon"</span>,<span class="st">"lat"</span><span class="op">)</span>, time <span class="op">=</span> <span class="st">"time"</span>, interval <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## BAUs: spatial BAUs are 1x1 pixels, temporal BAUs are 1 day intervals</span></span>
<span><span class="va">BAUs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/auto_BAUs.html">auto_BAUs</a></span><span class="op">(</span>manifold <span class="op">=</span> <span class="fu"><a href="reference/STplane.html">STplane</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                       cellsize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,    </span>
<span>                       data<span class="op">=</span><span class="va">STObj</span>, tunit <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span></span>
<span><span class="va">BAUs</span><span class="op">$</span><span class="va">fs</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># scalar fine-scale variance matrix, implicit in previous examples</span></span>
<span></span>
<span><span class="co">## Basis functions</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/auto_basis.html">auto_basis</a></span><span class="op">(</span>manifold <span class="op">=</span> <span class="fu"><a href="reference/STplane.html">STplane</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">STObj</span>, nres <span class="op">=</span> <span class="fl">2</span>, tunit <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Run FRK</span></span>
<span><span class="va">STObj</span><span class="op">$</span><span class="va">std</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># fix the measurement error variance</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/SRE.html">FRK</a></span><span class="op">(</span>f <span class="op">=</span> <span class="va">z</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">lat</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">STObj</span><span class="op">)</span>,</span>
<span>         basis <span class="op">=</span> <span class="va">G</span>, BAUs <span class="op">=</span> <span class="va">BAUs</span>, est_error <span class="op">=</span> <span class="cn">FALSE</span>, method <span class="op">=</span> <span class="st">"TMB"</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">S</span>, percentiles <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Plotting: include only some times via the argument subset_time</span></span>
<span><span class="va">plotlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">pred</span><span class="op">$</span><span class="va">newdata</span>, subset_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">7</span>, <span class="fl">13</span>, <span class="fl">19</span>, <span class="fl">25</span>, <span class="fl">31</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">plotlist</span>, nrow <span class="op">=</span> <span class="fl">1</span>, legend <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
<!---
## Apply a labeller so the facet shows day x rather than just x
facet_names <- paste0("day ", unique(pred$newdata$t))
names(facet_names) <- unique(pred$newdata$t)
plotlist <- lapply(plotlist, function(gg) gg + facet_wrap(~t, labeller = as_labeller(facet_names)))

ggsave(
  ggarrange(plotlist = plotlist, nrow = 1, legend = "top"),
  filename = "ST_data.png", device = "png",
  width = 12.5, height = 3.8,
  path = "man/figures/"
)
--->
<div class="float">
<img src="https://github.com/andrewzm/FRK/blob/master/man/figures/ST_data.png?raw=true" alt="(Left) Prediction of spatio-temporal process. (Right) Prediction interval width."><div class="figcaption">(Left) Prediction of spatio-temporal process. (Right) Prediction interval width.</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="demonstrations">Demonstrations<a class="anchor" aria-label="anchor" href="#demonstrations"></a>
</h2>
<p>The package <code>FRK</code> is currently being used to generate spatio-temporal animations of fields observed by satellite data. <a href="https://www.youtube.com/watch?v=_kPa8VoeSdM" class="external-link">Here</a> we show a daily prediction of CO2 using data from the NASA OCO-2 between September 2014 and June 2016.</p>
<p><a href="https://www.youtube.com/watch?v=ENx4CIZdoQk" class="external-link"><img src="https://img.youtube.com/vi/ENx4CIZdoQk/0.jpg" alt="alt tag"></a></p>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<p>Thanks to <a href="https://mbertolacci.github.io/" class="external-link">Michael Bertolacci</a> for designing the FRK hex logo!</p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=FRK" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/andrewzm/FRK/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/andrewzm/FRK/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing FRK</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Andrew Zammit-Mangion <br><small class="roles"> Author, maintainer </small>  </li>
<li>Matthew Sainsbury-Dale <br><small class="roles"> Author </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=FRK" class="external-link FRK-release"><img src="https://www.r-pkg.org/badges/version/FRK" alt="CRAN Status"></a></li>
<li><a href="https://github.com/andrewzm/FRK?branch=master" class="external-link"><img src="https://github.com/andrewzm/FRK/actions/workflows/check-standard.yaml/badge.svg?branch=master" alt="https://github.com/andrewzm/FRK/actions/workflows/check-standard.yaml/badge.svg?branch=master"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrew Zammit-Mangion, Matthew Sainsbury-Dale.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
